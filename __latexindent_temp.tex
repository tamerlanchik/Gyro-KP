\documentclass[main.tex]{subfiles}
\begin{document}

\subsection{Назначение и принцип работы прибора}
Заданный курсовой прибор является гирополукомпасом, так как предназначен для отслеживания 
заданного азимута. Гирополукомпас (ГПК) – курсовой гироскопический прибор, построенный 
на основе трехстепенного астатического гироскопа, имеет системы горизонтальной и 
азимутальной коррекции. Кинематическая схема ГПК приведена на рисунке 1. Система 
горизонтальной коррекции состит из ЧЭ – датчика угла \( \text{ДУ}_1 \), расположенного по оси 
внутренней рамки гироскопа, и исполнительного элемента – электродвигателя ЭДВ, 
создающего момент относительно оси наружной рамки \( Oy_1 \). Базовая система 
координат \( O\xi\eta\zeta \) - географическая.\par

При отклонении вектора Н от плоскости горизонта на угол \( \beta \) на выходе \( \text{ДУ}_1 \)
 появляется напряжение \( U=K_\text{ДУ}\beta \) при \( \beta < \beta_\text{п} \). 
 ЭДВ при наличии тока создает момент \( M_\text{эдв}=E\beta \)относительно оси 
 наружной рамки \( Oy_1 \), из-за чего возникает прецессия гироскопа 
 \( \dot{\beta}=\frac{M_\text{эдв}}{H} = \frac{E\beta}{H} = \varepsilon\beta \). \par

Датчик момента ДМ азимутальной коррекции управляется напряжением, поступающим 
с пульта, и компенсирует величину \( \omega_\zeta \approx U\sin(\varphi) \). Момент ДМ
азимутальной коррекции \( M_{\text{ДМ}_2} \approx H\omega_\zeta = HU/sin(\varphi)\).
 Система азимутальной коррекции позволяет скомпенсировать постоянную 
 составляющую \( \omega_0 \) собственной скорости прецессии. Поэтому на пульте
  устанавливаются 2 потенциометра со шкалами \( \varphi \) (в градусах – широта), и 
  \( \omega_0 \) (гр/ч). Величину \( \omega_0 \) определяют по показаниям ГПК в сравнении
   с показаниями других средств (GPS, магнитный компас) на стоянке аэродрома 
   или в прямолинейном полете с постоянной линейной скоростью. Момент азимутальной 
   коррекции с учетом \( \omega_0 \): \( M_{\text{ДМ}_2} \approx H(U\sin(\varphi) + \omega_0 \). \par

ГПК предназначены для отслеживания азимута (заданного направления) и находят 
широкое применение в авиации и наземных объектах.

\newcommand{\Mdd}{M_\text{ДД}}
\newcommand{\Koc}{K_\text{ОС}}
\newcommand{\Ad}{A_\text{д}}
\newcommand{\ad}{\alpha_\text{д}}

\subsection{Уравнения движения ГПК с соответствующей нелинейностью}
\begin{enumerate}
    \item Уравнение движения наружной рамки:
    \[ A\ddot{\alpha} +  \Mdd - H\dot{\beta} - \Koc\beta + \varphi(\dot{\alpha}) = M_\alpha\]

    \item Уравнение движения внутренней рамки
    \[ B\ddot{\beta} + \mu_\beta\dot{\beta} + H\dot{\alpha} = M_\beta \]

    \item Уравнение движения динамического демфера
    \[ \Ad\ddot{\ad} - \Mdd = M_{\ad} \]

    \item Момент динамического демфера
    \[ \Mdd = \mu(\dot{\alpha} - \dot{\ad}) + C(\alpha - \ad) \]
\end{enumerate}

\subsection{Расчёт выражения для передаточных функций гиросистемы как объекта управления и как объекта стабилизации}
    Запишем уравнения движения без учета трения в опорах (и, соответственно, нелинейности):
    \begin{equation}\begin{cases}
        A\ddot{\alpha} +  \mu(\dot{\alpha} - \dot{\ad}) + C(\alpha - \ad) 
            - H\dot{\beta} - \Koc\beta = M_\alpha, \\
        B\ddot{\beta} + H\dot{\alpha} = M_\beta, \\
        \Ad\ddot{\ad} - \mu(\dot{\alpha} - \dot{\ad}) - C(\alpha - \ad) = M_{\ad}
    \end{cases}\end{equation}

    Преобразуем систему уравнений по Лапласу:
    \begin{equation}\begin{cases}
        A\alpha s^2 + \mu s(\alpha - \ad) + C(\alpha - \ad) - H\beta s - \Koc\beta= M_\alpha, \\
        B\beta s^2 + H\alpha s = M_\beta, \\
        \Ad\ad s^2 - \mu s(\alpha - \ad) - C(\alpha - \ad) = M_{\ad},
    \end{cases}\end{equation}

    и запишем в векторно-матричной форме:
    \[
    \begin{bmatrix}
        As^2 + \mu s + C & -Hs - \Koc & -\mu s - C \\
        Hs & Bs^2 & 0 \\
        -\mu s - C & 0 & \Ad s^2 + \mu s + C \\
    \end{bmatrix} \begin{bmatrix}\alpha \\ \beta \\ \ad\end{bmatrix} = 
    \begin{bmatrix}M_{\alpha} \\ M_{\beta} \\ M_{\ad} \\ \end{bmatrix}.
    \]
    
    Разрешим полученную систему уравнений относительно вектора 
    \( \begin{bmatrix} \alpha & \beta & \ad \end{bmatrix}^T\):

    \[
    \begin{bmatrix}\alpha \\ \beta \\ \ad\end{bmatrix} = 
    \begin{bmatrix}
        W^{\alpha}_{M_{\alpha}} & W^{\alpha}_{M_{\beta}} & W^{\alpha}_{M_{\ad}} \\
        W^{\beta}_{M_{\alpha}} & W^{\beta}_{M_{\beta}} & W^{\beta}_{M_{\ad}} \\
        W^{\ad}_{M_{\alpha}} & W^{\ad}_{M_{\beta}} & W^{\ad}_{M_{\ad}} \\
    \end{bmatrix} \begin{bmatrix}M_{\alpha} \\ M_{\beta} \\ M_{\ad}\end{bmatrix}.
    \]

    Заметим, что искомая матрица передаточных функций - ни что иное как 
    обратная матрица системы уравнений. Получимеё с помощью возможностей символьного 
    вычисления Matlab. Для дальнейшей работы необходимы лишь две передаточных функции,
    их и запишем:
    \begin{enumerate}
        \item системы как объекта управления
            \[ W^{\beta}_{M_{\alpha}} = \frac{-H(\Ad s^2 + \mu s + C)}{\Delta}, \]

        \item системы как объекта стабилизации
            \[ W^{\alpha}_{M_{\alpha}} = \frac{Bs(\Ad s^2 + \mu s + C)}{\Delta}, \]        
    \end{enumerate}
    Здесь \( \Delta \) - определитель матрицы системы (после сокращения одной s):
    \[ \Delta = A\Ad B s^5 + \mu B(A+\Ad)s^4 + (\Ad H^2+BC(A+\Ad))s^3 + \] 
        \[+ H(\Ad\Koc+H\mu)s^2 + H(CH+\Koc\mu)s + CH\Koc. \] \par
    Получили передаточные функции системы как объекта управления и объекта стабилизации
    в общем виде.

\subsection{Оптимизация параметров упруго-диссипативной связи динамических 
элементов гиросистемы по критерию \( minmax |W(j\omega)| \)}

    Проведём оптимизацию параметров \( \mu \) и C для ДД. Для этого рассмотрим разомкнутую
    ПФ курсового гироскопа как объекта стабилизации (принимаем \( \Koc=0 \)).\par 

    Запишем полное выражение вышеназванной ПФ с указанными допущениями:
    \[ W^{\alpha}_{M_{\alpha}} = \frac{
        Bs(\Ad s^2 + \mu s + C)
    }{
        A\Ad B s^5 + \mu B(A+\Ad)s^4 + (\Ad H^2+BC(A+\Ad))s^3 + H^2\mu s^2 + CH^2s
    } \]

    Эта ПФ обладает замечательным свойством: при одном значении C, но разных \( \mu \), на АЧХ 
    будут существовать две инвариантные точки (все АЧХ пересекаются в них). При изменении С эти 
    точки будут перемещаться. \par 

    Целью оптимизации является минимизация максимумов АЧХ ПФ, а именно минимизация резонансных 
    пиков АЧХ. Таким образом, учитывая особенности нашей ПФ, оптимизация сводится к следующим
    двум этапам:
    \begin{itemize}
        \item Поиск значения \( C^* \), при котором инвариантные точки будут располагаться 
        на одном уровне, тем самым обеспечивается минимальное значение амплитуды в обеих инвариантных точках;
        \item Поиск значения \( \mu^* \), обеспечивающего минимальное значение резонансных пиков.
    \end{itemize}

    \subsubsection*{Поиск значения \( C^* \)}
    Условие инвариантности имеет следующий вид:
    \[ |W(j\omega)|_{\mu=0} = |W(j\omega)|_{\mu=\infty} \]
    После раскрытия модуля получаем:
    \[ W(j\omega)_{\mu=0} = -W(j\omega)_{\mu=\infty}\]
    
    С помощью Matlab вычислим пределы:
    \[ \frac{
        B(\Ad(j\omega)^2 + C)
    }{
        A\Ad B (j\omega)^4 + (\Ad H^2+BC(A+\Ad))(j\omega)^2
    } = \frac{-B}{B(A+\Ad)(j\omega)^2 + H^2} \]
    \[ \frac{
        B(\Ad\omega^2 - C)
    }{
        A\Ad B\omega^4 - (\Ad H^2+BC(A+\Ad))\omega^2 + CH^2
    } = \frac{B}{H^2  - B(A+\Ad)\omega^2} \]
    
    Решаем уравнение относительно C. В результате получаем четыре корня. Два из них отрицательные и не 
    удовлетворяют ОДЗ. Два других же вполне соответствуют инвариантным точкам \( \omega_1 \) и \( \omega_2 \):
    \[ \omega_{1,2} = \sqrt{\frac{
        \Ad H^2 + BC(A + \Ad) \pm \sqrt{B^2C^2(A^2+\Ad^2) + 2A\Ad BC^2 - 2A\Ad BCH^2 + \Ad^2H^4}
    }{\Ad B(2A + \Ad)}} \]

    Подставив численные значения, получаем следующие функции:
    \[ \omega_{1,2} = \sqrt{\frac{
        10^6 + 0,6C \pm \sqrt{0,36C^2 - 10^6C + 10^{12}}
    }{11}} \]

    Как было замечено в начале, в инвариантных точках значения С равны.
    
    

\end{document}